<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Block Puzzle</title>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }

        h1 {
            color: #1a73e8;
            margin-bottom: 20px;
        }

        .instructions {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            text-align: left;
        }

        .instructions h2 {
            color: #1a73e8;
            margin-top: 0;
        }

        .instructions ul {
            margin: 0;
            padding-left: 20px;
        }

        .instructions li {
            margin: 8px 0;
        }

        .game-container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-weight: 500;
        }

        .grid {
            display: inline-block;
            background-color: #e8f0fe;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .row {
            display: flex;
        }

        .cell {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            background-color: white;
            border: 2px solid #1a73e8;
            margin: 2px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .cell:hover {
            background-color: #e8f0fe;
        }

        .cell.selected {
            background-color: #1a73e8;
            color: white;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: #1a73e8;
            color: white;
        }

        button:hover:not(:disabled) {
            background-color: #1557b0;
        }

        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .word-list {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 4px;
            max-height: 200px;
            overflow-y: auto;
        }

        .word-list h3 {
            margin-top: 0;
            color: #1a73e8;
        }

        .word-list ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 8px;
        }

        .word-list li {
            background-color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .word-list li:hover {
            background-color: #e8f0fe;
        }

        @media (max-width: 600px) {
            .cell {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }

            .stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .word-list ul {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Word Block Puzzle</h1>
        <div class="instructions">
            <h2>How to Play</h2>
            <ul>
                <li>Find words in the grid by connecting letters horizontally, vertically, or diagonally.</li>
                <li>Words must be at least 3 letters long.</li>
                <li>You can swap any two letters to create new words.</li>
                <li>Click "Submit" to check your words and calculate your score.</li>
                <li>Longer words earn more points!</li>
            </ul>
        </div>
    <div id="root"></div>
    </div>

    <script type="text/babel">
        // Load dictionary
        const DICTIONARY = new Set([
            // Common 3-letter words
            'the', 'and', 'for', 'are', 'but', 'not', 'you', 'all', 'any', 'can', 'had', 'her',
            // ... rest of the dictionary words ...
            'yield', 'young', 'youth'
        ]);

        // Helper function to generate random letters with weighted distribution
        function generateRandomLetter() {
            const vowels = 'aeiou';
            const consonants = 'bcdfghjklmnpqrstvwxyz';
            const weights = {
                vowels: 0.4,
                consonants: 0.6
            };
            
            const random = Math.random();
            if (random < weights.vowels) {
                return vowels[Math.floor(Math.random() * vowels.length)];
            } else {
                return consonants[Math.floor(Math.random() * consonants.length)];
            }
        }

        // Helper function to check if a word exists in the dictionary
        function isValidWord(word) {
            return DICTIONARY.has(word.toLowerCase());
        }

        // Helper function to check and add a word if it's valid
        function checkAndAddWord(word, foundWords) {
            if (word.length >= 3 && isValidWord(word)) {
                foundWords.add(word.toLowerCase());
            }
        }

        function WordGridGame() {
            const [grid, setGrid] = React.useState([]);
            const [selectedCells, setSelectedCells] = React.useState([]);
            const [foundWords, setFoundWords] = React.useState(new Set());
            const [score, setScore] = React.useState(0);
            const [highScore, setHighScore] = React.useState(() => {
                const saved = localStorage.getItem('wordBlockHighScore');
                return saved ? parseInt(saved) : 0;
            });
            const [time, setTime] = React.useState(0);
            const [isTimerRunning, setIsTimerRunning] = React.useState(false);

            // Timer effect
            React.useEffect(() => {
                let interval;
                if (isTimerRunning) {
                    interval = setInterval(() => {
                        setTime(prevTime => prevTime + 1);
                    }, 1000);
                }
                return () => clearInterval(interval);
            }, [isTimerRunning]);

            // Format time as MM:SS
            const formatTime = (seconds) => {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
            };

            // Start timer
            const startTimer = () => {
                setIsTimerRunning(true);
            };

            // Stop timer
            const stopTimer = () => {
                setIsTimerRunning(false);
            };

            // Update high score
            const updateHighScore = (newScore) => {
                if (newScore > highScore) {
                    setHighScore(newScore);
                    localStorage.setItem('wordBlockHighScore', newScore);
                }
            };

            // Generate initial grid
            const generateInitialGrid = () => {
                const newGrid = [];
                for (let i = 0; i < 5; i++) {
                    const row = [];
                    for (let j = 0; j < 5; j++) {
                        row.push(generateRandomLetter());
                    }
                    newGrid.push(row);
                }
                setGrid(newGrid);
                setSelectedCells([]);
                setFoundWords(new Set());
                setScore(0);
                setTime(0);
                startTimer();
            };

            // Find all words in the grid
            const findAllWords = () => {
                const words = new Set();

                // Check horizontal words
                for (let i = 0; i < 5; i++) {
                    for (let j = 0; j < 3; j++) {
                        const word = grid[i][j] + grid[i][j + 1] + grid[i][j + 2];
                        checkAndAddWord(word, words);
                        if (j < 2) {
                            const word4 = word + grid[i][j + 3];
                            checkAndAddWord(word4, words);
                            if (j < 1) {
                                const word5 = word4 + grid[i][j + 4];
                                checkAndAddWord(word5, words);
                            }
                        }
                    }
                }

                // Check vertical words
                for (let i = 0; i < 3; i++) {
                    for (let j = 0; j < 5; j++) {
                        const word = grid[i][j] + grid[i + 1][j] + grid[i + 2][j];
                        checkAndAddWord(word, words);
                        if (i < 2) {
                            const word4 = word + grid[i + 3][j];
                            checkAndAddWord(word4, words);
                            if (i < 1) {
                                const word5 = word4 + grid[i + 4][j];
                                checkAndAddWord(word5, words);
                            }
                        }
                    }
                }

                // Check diagonal words (top-left to bottom-right)
                for (let i = 0; i < 3; i++) {
                    for (let j = 0; j < 3; j++) {
                        const word = grid[i][j] + grid[i + 1][j + 1] + grid[i + 2][j + 2];
                        checkAndAddWord(word, words);
                        if (i < 2 && j < 2) {
                            const word4 = word + grid[i + 3][j + 3];
                            checkAndAddWord(word4, words);
                            if (i < 1 && j < 1) {
                                const word5 = word4 + grid[i + 4][j + 4];
                                checkAndAddWord(word5, words);
                            }
                        }
                    }
                }

                // Check diagonal words (top-right to bottom-left)
                for (let i = 0; i < 3; i++) {
                    for (let j = 2; j < 5; j++) {
                        const word = grid[i][j] + grid[i + 1][j - 1] + grid[i + 2][j - 2];
                        checkAndAddWord(word, words);
                        if (i < 2 && j > 2) {
                            const word4 = word + grid[i + 3][j - 3];
                            checkAndAddWord(word4, words);
                            if (i < 1 && j > 3) {
                                const word5 = word4 + grid[i + 4][j - 4];
                                checkAndAddWord(word5, words);
                            }
                        }
                    }
                }

                return words;
            };

            // Calculate score based on found words
            const calculateScore = (words) => {
                let totalScore = 0;
                words.forEach(word => {
                    if (word.length === 3) totalScore += 1;
                    else if (word.length === 4) totalScore += 2;
                    else if (word.length >= 5) totalScore += 4;
                });
                return totalScore;
            };

            // Handle cell selection
            const handleCellClick = (row, col) => {
                const cellIndex = row * 5 + col;
                if (!selectedCells.includes(cellIndex)) {
                    setSelectedCells([...selectedCells, cellIndex]);
                }
            };

            // Handle swap
            const handleSwap = () => {
                if (selectedCells.length === 2) {
                    const [first, second] = selectedCells;
                    const row1 = Math.floor(first / 5);
                    const col1 = first % 5;
                    const row2 = Math.floor(second / 5);
                    const col2 = second % 5;

                    const newGrid = [...grid];
                    const temp = newGrid[row1][col1];
                    newGrid[row1][col1] = newGrid[row2][col2];
                    newGrid[row2][col2] = temp;

                    setGrid(newGrid);
                    setSelectedCells([]);
                }
            };

            // Handle submit
            const handleSubmit = () => {
                const words = findAllWords();
                const newScore = calculateScore(words);
                setFoundWords(words);
                setScore(newScore);
                updateHighScore(newScore);
                stopTimer();
            };

            // Handle reset
            const handleReset = () => {
                generateInitialGrid();
            };

            // Initialize grid on component mount
            React.useEffect(() => {
                generateInitialGrid();
            }, []);

            return (
                <div className="game-container">
                    <div className="stats">
                        <div className="stat-item">
                            <span>Time: {formatTime(time)}</span>
                        </div>
                        <div className="stat-item">
                            <span>Swapped: {selectedCells.length}/2</span>
                        </div>
                        <div className="stat-item">
                            <span>Words: {foundWords.size}</span>
                        </div>
                        <div className="stat-item">
                            <span>Score: {score}</span>
                        </div>
                        <div className="stat-item">
                            <span>High Score: {highScore}</span>
                        </div>
                    </div>

                    <div className="grid">
                        {grid.map((row, rowIndex) => (
                            <div key={rowIndex} className="row">
                                {row.map((cell, colIndex) => (
                                    <div
                                        key={`${rowIndex}-${colIndex}`}
                                        className={`cell ${selectedCells.includes(rowIndex * 5 + colIndex) ? 'selected' : ''}`}
                                        onClick={() => handleCellClick(rowIndex, colIndex)}
                                    >
                                        {cell}
                                    </div>
                                ))}
                            </div>
                        ))}
                    </div>

                    <div className="controls">
                        <button onClick={handleSwap} disabled={selectedCells.length !== 2}>
                            Swap
                        </button>
                        <button onClick={handleSubmit} disabled={selectedCells.length !== 0}>
                            Submit
                        </button>
                        <button onClick={handleReset}>Reset</button>
                    </div>

                    <div className="word-list">
                        <h3>Found Words:</h3>
                        <ul>
                            {Array.from(foundWords).sort().map((word, index) => (
                                <li key={index}>{word}</li>
                            ))}
                        </ul>
                    </div>
                </div>
            );
        }

        // Render the game
        ReactDOM.render(<WordGridGame />, document.getElementById('root'));
    </script>
</body>
</html>
